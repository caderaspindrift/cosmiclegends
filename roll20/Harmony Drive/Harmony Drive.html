<!-- PLAYER CHARACTER SHEET -->
<div class="container pc">
<input type="hidden" value="1.00.01" name="attr_version-name">

<input class="hiddencheckbox heroic-chord-button" type="checkbox" name="attr_game" value="heroic-chord" checked="checked">
<input class="hiddencheckbox cosmic-legends-button" type="checkbox" name="attr_game" value="cosmic-legends">
<input class="hiddencheckbox harmony-drive-button" type="checkbox" name="attr_game" value="harmony-drive">

<input class="hiddencheckbox whisper-toggle-checkbox" type="checkbox" name="attr_wtype" value="@{whisper-toggle}">

<input class="tab-button tab-whisper" type="checkbox" name="attr_whisper-toggle" value="/w gm "><span data-i18n="whisper-u">WHISPER</span>

<input class="tab-button tab1" type="radio" name="attr_tab" value="1" checked="checked"><span data-i18n="character-u">CHARACTER</span>
<input class="tab-button tab2" type="radio" name="attr_tab" value="2"><span data-i18n="persona-u">PERSONA</span>
<input class="tab-button tab3" type="radio" name="attr_tab" value="3"><span data-i18n="powers-u">POWER WORDS</span>
<input class="tab-button tab4" type="radio" name="attr_tab" value="4"><span data-i18n="focuses-u">ABILITIES</span>
<input class="tab-button tab5" type="radio" name="attr_tab" value="5"><span data-i18n="magic-u" class="magic-tab-span">MAGIC</span><span data-i18n="arcana-u" class="arcana-tab-span">ARCANA</span><span class="extraordinary-tab-span" data-i18n="extraordinary-u">EXTRAORDINARY</span>
<input class="tab-button tab6" type="radio" name="attr_tab" value="6"><span style="font-family: pictos">y</span> CONFIG

<!-- CHARACTER TAB -->
<div class="page tab1">
  <div class="header">
  </div>

	<!-- Approaches  -->
	<div class="apprch-container apprch-1">
	  <div class="col left-apprch-container">
            <div class="section-name apprches-section">
	      <div class="col apprch-name">
                <button class="apprches-button clotu" type="action" name="act_test">Approach 1</button>
	      </div>
	      <div class="col apprch-value">
		      <input type="number" name="attr_apprch_1" value="{attr_apprch_1"/>
	      </div>
	    </div>
	  </div>
	</div>
	<div class="apprch-container apprch-2">
	  <div class="col left-apprch-container">
            <div class="section-name apprches-section">
	      <div class="col apprch-name">
                <button class="apprches-button clotu" type="action" name="act_test">Approach 2</button>
	      </div>
	      <div class="col apprch-value">
		      <input type="number" name="attr_apprch_2" value="{attr_apprch_2"/>
	      </div>
	    </div>
	  </div>
	</div>
	<div class="apprch-container apprch-3">
	  <div class="col left-apprch-container">
            <div class="section-name apprches-section">
	      <div class="col apprch-name">
                <button class="apprches-button clotu" type="action" name="act_test">Approach 3</button>
	      </div>
	      <div class="col apprch-value">
		      <input type="number" name="attr_apprch_3" value="{attr_apprch_3"/>
	      </div>
	    </div>
	  </div>
	</div>
	<div class="apprch-container apprch-4">
	  <div class="col left-apprch-container">
            <div class="section-name apprches-section">
	      <div class="col apprch-name">
                <button class="apprches-button clotu" type="action" name="act_test">Approach 4</button>
	      </div>
	      <div class="col apprch-value">
	        <input type="number" name="attr_apprch_4" />
	      </div>
	    </div>
	  </div>
	</div>
	<div class="apprch-container apprch-5">
	  <div class="col left-apprch-container">
            <div class="section-name apprches-section">
	      <div class="col apprch-name">
                <button class="apprches-button clotu" type="action" name="act_test">Approach 5</button>
	      </div>
	      <div class="col apprch-value">
	        <input type="number" name="attr_apprch_5" />
	      </div>
	    </div>
	  </div>
	</div>
</div>

<!-- POWER WORDS TAB -->
<div class="page tab2">
  <div class="header">
  </div>
</div>

<!-- SKILLS TAB -->
<div class="page tab3">
  <div class="header">
  </div>
</div>

<!-- SYSTEM TAB -->
<div class="page tab6">
  <div class="header">
  </div>
</div>

<!-- OPTIONS TAB -->
<div class="page tab7">
  <div class="header">
  </div>
</div>

<!-- END OF PC SHEET -->
<!-- END OF PC SHEET -->
</div>

<rolltemplate class="sheet-rolltemplate-approach-roller">
  <div class="sheet-results">
    <h3>Approach-Roller template!</h3>
    <h4>Result = {{roll1}}</h4>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-test">
    <div class="sheet-template-container">
        <h1>{{name}}</h1>
        <div class="sheet-results">
            <h4>All Dice Rolls = {{computed::roll1}}  </h4>
	    <h4>Ones           = {{computed::ones}}   </h4>
	    <h4>Twos           = {{computed::twos}}   </h4>
	    <h4>Threes         = {{computed::threes}} </h4>
	    <h4>Fours          = {{computed::fours}}  </h4>
	    <h4>Fives          = {{computed::fives}}  </h4>
	    <h4>Sixes          = {{computed::sixes}}  </h4>
	    <h4>Edge Successes = {{computed::edge}}   </h4>
	    <h4>Successes      = {{computed::success}}</h4>
        </div>
    </div>
</rolltemplate>

<!-- Strings translations for Roll Queries-->
<div style="display: none;">
  <span data-i18n="additional_modifier2">Additional modifier</span>
  <span data-i18n="die_roll"            >Die Roll</span>
</div>

<script type="text/worker">
console.log("==================================");
console.log("Loading script(s)");

/*config Roll Queries translations */
on("sheet:opened", function(eventInfo){
  setAttrs({
    public_roll:           getTranslationByKey("public_roll"),
    whisper_roll:          getTranslationByKey("whisper_roll"),
    whisper:               getTranslationByKey("whisper"),
    fighting_label:        getTranslationByKey("fighting"),
    income_label:          getTranslationByKey("income_label"),
    accuracy_label:        getTranslationByKey("accuracy"),
    communication_label:   getTranslationByKey("communication"),
    constitution_label:    getTranslationByKey("constitution"),
    dexterity_label:       getTranslationByKey("dexterity"),
    perception_label:      getTranslationByKey("perception"),
    strength_label:        getTranslationByKey("strength"),
    willpower_label:       getTranslationByKey("willpower"),
    intelligence_label:    getTranslationByKey("intelligence"),
    cunning_label:         getTranslationByKey("cunning"),
    none:                  getTranslationByKey("none"),
    plus_one_tn:           getTranslationByKey("plus_one_tn"),
    power_cost_label:      getTranslationByKey("power_cost_label"),
    kanna_cost_label:      getTranslationByKey("kanna_cost_label"),
    fatigue_tn_label:      getTranslationByKey("fatigue_tn_label"),
    ability:               getTranslationByKey("ability"),
    ability_value:         getTranslationByKey("ability_value"),
    focus_value:           getTranslationByKey("focus_value"),
    additional_modifier:   getTranslationByKey("additional_modifier"),
    additional_modifier2:  getTranslationByKey("additional_modifier2"),
    ability_score:         getTranslationByKey("ability_score"),
    roll_description:      getTranslationByKey("roll_description"),
    die_roll:              getTranslationByKey("die_roll"),
    focus:                 getTranslationByKey("focus"),
    magic_label:           getTranslationByKey("magic"),
    magic_arcana_focus:    getTranslationByKey("magic_arcana_focus"),
    spellcasting_ability:  getTranslationByKey("spellcasting_ability"),
    psychic_ability:       getTranslationByKey("psychic_ability"),
    ability_focus:         getTranslationByKey("ability_focus"),
    arcana_focus:          getTranslationByKey("arcana_focus"),
    psychic_focus:         getTranslationByKey("psychic_focus"),
    fatigue_check_for:     getTranslationByKey("fatigue_check_for"),
    each_fatiguing_spell:  getTranslationByKey("each_fatiguing_spell"),
    fear_label:            getTranslationByKey("fear_label"),
    armor_penalty:         getTranslationByKey("armor_penalty"),
    initiative_adjustment: getTranslationByKey("initiative_adjustment"),
    initiative:            getTranslationByKey("initiative"),
    resources:             getTranslationByKey("resources"),
    attack_bonus_label:    getTranslationByKey("attack_bonus_label"),
    magic_arcana_focus:    getTranslationByKey("magic_arcana_focus"),
    spellpower_label:      getTranslationByKey("spellpower_label")
  });     
});

on('clicked:test', (info) => {
  console.log("You clicked the test!");
  startRoll("&{template:test} {{name=Test}} {{roll1=[[12d6]]}}", (results) => 
       {
            const total = results.results.roll1.result
            const computed = total % 4;

	    let returnValues = new Array(6);

	    returnValues[1] = 0;
	    returnValues[2] = 0;
	    returnValues[3] = 0;
	    returnValues[4] = 0;
	    returnValues[5] = 0;
	    returnValues[6] = 0;
	    
            for (const die of results.results.roll1.dice)
	    {  
	      console.log("this die is " + die);
	      returnValues[die] = returnValues[die]+1;
	    }
	    console.log("ones      = " + returnValues[1]);
	    console.log("twos      = " + returnValues[2]);
	    console.log("threes    = " + returnValues[3]);
	    console.log("fours     = " + returnValues[4]);
	    console.log("fives     = " + returnValues[5]);
	    console.log("sixes     = " + returnValues[6]);
	    console.log("edge      = " + returnValues[1]);
	    console.log("successes = " + (returnValues[5] + returnValues[6]));
            finishRoll( results.rollId, 
	      { ones:      returnValues[1],
	        twos:      returnValues[2],
		threes:    returnValues[3],
		fours:     returnValues[4],
		fives:     returnValues[5],
		sixes:     returnValues[6],
		edge:      returnValues[1],
		successes: returnValues[5]+returnValues[6],
		roll1:     results.results.roll1.dice
	      }
	    );
        });
    });

on("sheet:opened", 
  function(event) {
    console.log("opened sheet");
  }
); // on opened/changes

console.log("Script load complete");
console.log("==================================");
</script>
